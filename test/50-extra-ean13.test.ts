import { ValidationError, validate } from '../src'
import { ean13 } from '../src/extra/ean13'

describe('Extra EAN-13 Validator', () => {
  it('should validate all our EAN-13 codes', async () => {
    for (const ean of correct) {
      expect(validate(ean13, ean)).toEqual(ean)
    }
  })

  it('should validate an EAN-13 from a number', async () => {
    expect(validate(ean13, 9780966245417)).toEqual('9780966245417')
  })

  it('should reject a short EAN-13', () => {
    expect(() => validate(ean13, '123456789012'))
        .toThrow((assert) => assert
            .toBeError(ValidationError, /^Found 1 validation error$/m)
            .toHaveProperty('errors', (assert) => assert.toEqual([ {
              message: 'String must have a minimum length of 13',
              path: [],
            } ])),
        )
  })

  it('should reject a long EAN-13', () => {
    expect(() => validate(ean13, '12345678901234'))
        .toThrow((assert) => assert
            .toBeError(ValidationError, /^Found 1 validation error$/m)
            .toHaveProperty('errors', (assert) => assert.toEqual([ {
              message: 'String must have a maximum length of 13',
              path: [],
            } ])),
        )
  })

  it('should reject an invalid EAN-13', () => {
    expect(() => validate(ean13, 'aaaaaaaaaaaaa'))
        .toThrow((assert) => assert
            .toBeError(ValidationError, /^Found 1 validation error$/m)
            .toHaveProperty('errors', (assert) => assert.toEqual([ {
              message: expect.toMatch(/^String does not match required pattern /),
              path: [],
            } ])),
        )
  })

  it('should reject an EAN-13 with the wrong checksum', () => {
    expect(() => validate(ean13, '9780802409431'))
        .toThrow((assert) => assert
            .toBeError(ValidationError, /^Found 1 validation error$/m)
            .toHaveProperty('errors', (assert) => assert.toEqual([ {
              message: 'Invalid checksum in EAN-13 "9780802409431"',
              path: [],
            } ])),
        )
  })
})

const correct = [
  '9780802409430', '9781891595240', '9780897876254', '9780300091892', '9785887021454',
  '9789879960165', '9780764422799', '9780534264956', '9780517568439', '9782865377923',
  '9783110175752', '9780732274689', '9789682978739', '9781420102765', '9780914336556',
  '9780538140201', '9781557666291', '9780439897518', '9780310607106', '9788484566052',
  '9780471614470', '9780548573617', '9780716789017', '9780548693711', '9783540784395',
  '9781592964727', '9780606028479', '9780559649769', '9780451129567', '9780295956190',
  '9780252014628', '9780548879740', '9781420878844', '9780882293820', '9781580330060',
  '9781434304155', '9781605975993', '9780884964087', '9780976425625', '9781424151523',
  '9780756400071', '9781604537871', '9780573691980', '9789871081073', '9781412094054',
  '9780720472288', '9788480181129', '9789683644237', '9780941451765', '9781591607663',
  '9780911307764', '9780376042989', '9781556551529', '9780891168607', '9788301027599',
  '9780141316093', '9788430021772', '9780859676908', '9783854206934', '9780976096702',
  '9785808400788', '9781421977287', '9780811842174', '9780892060795', '9780687300303',
  '9780521676380', '9780883183885', '9781604743531', '9780877596462', '9780516204420',
  '9780613753890', '9780153402876', '9781883717278', '9780965916455', '9780030746673',
  '9783718603107', '9780078820908', '9781877059162', '9781841210131', '9780805724059',
  '9780387074283', '9781597711227', '9781600142703', '9789290221944', '9781558963672',
  '9781933662039', '9789709022612', '9780870658426', '9781401876623', '9789793285030',
  '9788991331990', '9783453059085', '9780774814430', '9781559144636', '9780886461911',
  '9783880201996', '9780850668513', '9780387978390', '9780340977743', '9780325006840',
  '9780320054495', '9783889852700', '9780801057144', '9780824059378', '9780449446331',
  '9780307110541', '9780671744779', '9780520227675', '9780671554811', '9780700706464',
  '9781420853483', '9781553675570', '9783902053053', '9789759546502', '9789715502948',
  '9783810722683', '9780977637126', '9789660213586', '9781427074997', '9789684116467',
  '9780809118908', '9780802794512', '9780787661502', '9789632085289', '9788420448169',
  '9780803945456', '9780976728306', '9789179003081', '9781883884253', '9783876270166',
  '9780781710138', '9780952000402', '9780554714370', '9780686178101', '9784770015341',
  '9788435504300', '9780966245417', '9780688164997', '9782708700871', '9780787669928',
  '9781875943258', '9780824076757', '9788834812433', '9780852700594', '9783908450320',
  '9780123875600', '9780528860669', '9780451522481', '9789022308752', '9780345018793',
  '9784582841961', '9780548887455', '9780920576830', '9787536717725', '9780801982811',
  '9780064405102', '9780881955101', '9789781421662', '9780333150986', '9782717816976',
  '9780521056779', '9781441907165', '9789507100451', '9781873410240', '9780844659442',
  '9780160450488', '9780768835977', '9781557731302', '9780793827626', '9780143001355',
  '9780590448901', '9781930455504', '9780814471982', '9780933979154', '9781894020831',
  '9788439349754', '9780662265955', '9780822201991', '9781103984282', '9788481746433',
  '9780712621533', '9780160526589', '9780812108231', '9783923120000', '9780786137565',
  '9788813261849', '9781841151380', '9780884020646', '9780865680616', '9780761471714',
  '9788496515024', '9780471079965', '9783639114201', '9781585790272', '9780898700459',
  '9788750347583', '9781891438011', '9781563052477', '9780805080230', '9780870001154',
  '9783475520976', '9780559253904', '9780030000645', '9789872060404', '9780061012099',
  '9781110304035', '9781556709838', '9780522840179', '9780809302192', '9781581742442',
  '9780536609137', '9783878763123', '9780553542264', '9780899709406', '9781555036928',
  '9780862644512', '9781559391443', '9780895245229', '9781602833043', '9783351011703',
  '9780613210959', '9789879395325', '9780812575620', '9780230602250', '9783060061204',
  '9781880399330', '9781401084653', '9788301105396', '9788487641282', '9785767100804',
  '9780590333221', '9780958190534', '9781426452000', '9780899256351', '9781413711271',
  '9780837368054', '9780340734865', '9780763114428', '9781428007642', '9781593110574',
  '9788474967333', '9781740593687', '9780006380436', '9780967989600', '9781428624559',
  '9780764319334', '9780896086296', '9788475660158', '9788431502669', '9780458961009',
  '9780595281824', '9780825416057', '9780921057635', '9780606005043', '9780892364671',
  '9780825422973', '9781592133659', '9781426430367', '9788846407504', '9781598699906',
  '9780716304173', '9781581979459', '9789745971547', '9780913153031', '9781556422928',
  '9781905042289', '9788466754460', '9780768206340', '9780195423235', '9788486047238',
  '9780706370089', '9781854751768', '9785835403011', '9780060469030', '9780554904191',
  '9781600610936', '9780768602876', '9781564320889', '9780792396574', '9789994282951',
  '9788446007371', '9780896361485', '9780764507847', '9780813123752', '9780528276316',
  '9780451602206', '9780704401808', '9781404104242', '9780521391177', '9780415485067',
  '9780668023368', '9780905118352', '9780853340515', '9781104403539', '9780314988126',
  '9780030131363', '9780738501925', '9788822237064', '9780688138073', '9781555231361',
  '9780691024318', '9781560440260', '9780520251151', '9781561592708', '9789794594704',
  '9781847611130', '9780446768894', '9788460487609', '9780853621164', '9780818904615',
  '9781104405106', '9780915869008', '9780950097510', '9781425909376', '9781419665851',
  '9781877967078', '9780817264352', '9780321537119', '9782051015752', '9780690016956',
  '9780697345356', '9780941845083', '9788450048582', '9780803733459', '9780201586336',
  '9780812042191', '9780697168092', '9785288019807', '9780756746124', '9780192111937',
  '9780823217755', '9780307038074', '9780470150566', '9780787228002', '9780397504039',
  '9784476072235', '9781426914591', '9780471487067', '9780849303982', '9781420834574',
  '9780123695352', '9782879390079', '9780760108802', '9780380975662', '9780966480634',
  '9780852342701', '9780446342445', '9782864182269', '9780852312100', '9788588787018',
  '9780521833912', '9780972402255', '9780738515632', '9780681417106', '9782902402892',
  '9780435901554', '9780021642700', '9783642053276', '9788186030615', '9781558501027',
  '9780887294228', '9781560114048', '9781583880425', '9781852916008', '9780816517732',
  '9780716500537', '9780936388939', '9780375946769', '9783540897835', '9780821772133',
  '9781853715495', '9788427304819', '9780939513437', '9783814401713', '9780486437385',
  '9789264137790', '9781401025663', '9781933087368', '9783865219121', '9780892871322',
  '9782760513099', '9780917734243', '9788440092762', '9781558686410', '9780811208352',
  '9780934385824', '9783428072149', '9780521215947', '9780441049127', '9789173840149',
  '9780606054690', '9780415033848', '9789053565766', '9780780339132', '9780256069266',
  '9783201013109', '9780761471899', '9780140223248', '9780939314362', '9781551642123',
  '9780548577066', '9789211262322', '9788430621903', '9780312874889', '9780753196557',
  '9780641577833', '9781439505847', '9781413789362', '9780304936151', '9780398018207',
  '9788484564850', '9780671739829', '9780495130390', '9788885148444', '9789544452230',
  '9781417737826', '9789654932981', '9780199230273', '9780951375723', '9780833540430',
  '9781591912439', '9780689102523', '9780613441728', '9782921556729', '9780822339571',
  '9788171431892', '9780313255298', '9780471549895', '9781421967271', '9781103825097',
  '9780898839784', '9780766179417', '9780026655903', '9780801825408', '9780153049910',
  '9780825410383', '9780951214039', '9780787947897', '9789630932028', '9781594538728',
  '9780554494005', '9781902588001', '9780903729956', '9780060972707', '9780194315852',
  '9781558701298', '9780963425713', '9780844731971', '9780752859774', '9780471172178',
  '9781901414103', '9780750529488', '9780817616434', '9780827384729', '9780724102556',
  '9780007170562', '9781404366909', '9788820488284', '9789688054130', '9780559104237',
  '9780774027779', '9781877295812', '9783150096413', '9780517650103', '9781432673635',
  '9781566392143', '9781564962652', '9781878327024', '9782060034713', '9780345277022',
  '9780553207958', '9781904303558', '9780387193823', '9780314934505', '9780947183127',
  '9783883756097', '9780134528311', '9780812817577', '9780804809726', '9781556224188',
  '9780440219910', '9780607920833', '9780275982249', '9781425055158', '9781608762910',
  '9787306000323', '9781565545502', '9780871011909', '9789062651979', '9781595434715',
  '9780735526495', '9783404920587', '9788450022056', '9780323016117', '9780312170080',
  '9780914019589', '9781439231074', '9780873064910', '9781403917386', '9781104410193',
  '9780226104454', '9780810101616', '9788427002012', '9789290446828', '9780963416001',
  '9782738473288', '9789848684351', '9781437079364', '9780762000418', '9780754818571',
  '9780586037300', '9782718801100', '9781857110142', '9780811867610', '9789060007808',
  '9780252061035', '9788473988803', '9780559233210', '9783499143915', '9780852244975',
  '9780160376443', '9780837310329', '9780306377259', '9788450565645', '9780394405483',
  '9781432566234', '9780300125832', '9783905455199', '9780737300277', '9781553662440',
  '9780415953344', '9783701172047', '9783260050084', '9788487583285', '9780894558689',
  '9780078262401', '9780910110372', '9782729112738', '9788493052447', '9789681212483',
  '9780938922049', '9780373672868', '9780136416050', '9780851704043', '9789549090444',
  '9780963884923', '9789771331209', '9780817982225', '9780803214279', '9780030369339',
  '9780968153055', '9783597101091', '9789590804113', '9781891859564', '9780756717612',
  '9780769516370', '9780559304620', '9781408009222', '9780452263215', '9780883290361',
  '9788870147711', '9780396004691', '9788485354085', '9780763700867', '9780936384368',
  '9780854404216', '9789514423239', '9780849215377', '9781587798443', '9789681674120',
  '9785340012425', '9780751531626', '9788520301470', '9780198249078', '9780345364708',
  '9780525246657', '9788474908008', '9788798677208', '9781550411980', '9780737725650',
  '9781103726714', '9788817014717', '9780872911659', '9780801855252', '9781432566647',
  '9789711000288', '9787800709630', '9782729887377', '9783406346217', '9788436809503',
  '9781417699926', '9781567589603', '9789210612739', '9782844660565', '9780471502845',
  '9780806134390', '9781404335417', '9781561563067', '9780803923379', '9782911606700',
  '9780713446258', '9780061814341', '9788477400660', '9780716717515', '9780963968500',
  '9782873170349', '9780451179371', '9782907150224', '9789781328336', '9783540625551',
  '9780691116952', '9780140770339', '9780713721683', '9789155023560', '9781103796014',
  '9780714843803', '9780669909777', '9789974779303', '9780198610755', '9785270006044',
  '9780907305392', '9789291180707', '9780497260637', '9789715013253', '9780070221574',
  '9780159290200', '9780836891133', '9783506767820', '9788186385432', '9781878569677',
  '9788871230870', '9780807822562', '9780897110099', '9780613437974', '9789684092099',
  '9780974407807', '9780439782487', '9789879749883', '9780126407402', '9780373766468',
  '9781932472691', '9789264044494', '9783608910148', '9788431501051', '9780613172011',
  '9780824776466', '9780395264287', '9789559570103', '9789687155111', '9781557045447',
  '9781581804355', '9780772610577', '9780590206013', '9781421824215', '9780720407013',
  '9780896861817', '9781602190078', '9781566919227', '9780471899631', '9781559636001',
  '9780873648226', '9780759243996', '9780613165297', '9780533134908', '9788586611278',
  '9780387564760', '9785713304027', '9781853675003', '9780521589871', '9780719070464',
  '9780300105292', '9780312493189', '9780911378900', '9781437813005', '9780573605741',
  '9788487146596', '9788420457062', '9789138049488', '9789686154061', '9780028605722',
  '9781552750230', '9781891643026', '9781874105596', '9780613060950', '9780030555749',
  '9780160840876', '9780439429825', '9781928893028', '9780854563647', '9780373752454',
  '9780965850889', '9780747586128', '9789507823572', '9780133319422', '9781606991466',
  '9781595250001', '9780521085199', '9781437522587', '9780065010374', '9788486072049',
  '9780415763844', '9780871319999', '9780788302565', '9782070406951', '9780160799976',
  '9780822937791', '9780684106021', '9780521095068', '9789517352918', '9789138066843' ]
